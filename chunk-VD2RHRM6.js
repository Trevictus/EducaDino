import{a as H}from"./chunk-TFKMEESS.js";import"./chunk-TGME2SXI.js";import{j as $,l as Y,m as j}from"./chunk-4RMWBARQ.js";import{l as I,m as A}from"./chunk-4EGEY6OO.js";import{$a as O,Db as T,Fb as V,Gb as F,Ib as N,Ja as z,Mb as b,O as C,T as p,Ta as D,U as _,Va as m,Wa as f,Ya as L,Za as k,_a as w,ab as n,bb as o,cb as E,ea as h,gb as v,kb as g,mb as d,sa as S,ub as P,wb as i,xa as s,xb as x,yb as M}from"./chunk-5N3JP377.js";import{a as l,b as u}from"./chunk-2NFLSA4Y.js";var B=r=>["/productos",r],R=(r,e)=>e.id;function Q(r,e){if(r&1){let t=v();n(0,"div",4)(1,"span",11),i(2,"\u2705"),o(),n(3,"span",12),i(4),o(),n(5,"button",13),g("click",function(){p(t);let c=d();return _(c.dismissSuccess())}),i(6," \u2715 "),o()()}if(r&2){let t=d();s(4),x(t.state().successMessage)}}function U(r,e){if(r&1){let t=v();n(0,"div",5)(1,"div",14)(2,"span",15),i(3,"\u26A0\uFE0F"),o(),n(4,"div",16)(5,"strong"),i(6,"Error al cargar productos"),o(),n(7,"p"),i(8),o()()(),n(9,"div",17)(10,"button",18),g("click",function(){p(t);let c=d();return _(c.retryLoad())}),i(11," \u{1F504} Reintentar "),o(),n(12,"button",19),g("click",function(){p(t);let c=d();return _(c.dismissError())}),i(13," \u2715 "),o()()()}if(r&2){let t=d();s(8),x(t.state().error)}}function W(r,e){if(r&1){let t=v();n(0,"button",21),g("click",function(){let c=p(t).$implicit,y=d(2);return _(y.filterByCategory(c))}),i(1),o()}if(r&2){let t=e.$implicit,a=d(2);P("products__filter-btn--active",a.currentCategory()===t),s(),M(" ",t," ")}}function G(r,e){if(r&1){let t=v();n(0,"nav",6)(1,"span",20),i(2,"Filtrar:"),o(),n(3,"button",21),g("click",function(){p(t);let c=d();return _(c.clearCategoryFilter())}),i(4," Todos "),o(),k(5,W,2,3,"button",22,L),o()}if(r&2){let t=d();s(3),P("products__filter-btn--active",!t.currentCategory()),s(2),w(t.getCategories())}}function J(r,e){r&1&&(n(0,"div",7)(1,"div",23),E(2,"div",24),n(3,"span",25),i(4,"\u{1F996}"),o()(),n(5,"p",26),i(6,"Cargando productos..."),o()())}function K(r,e){r&1&&(n(0,"span",30),i(1,"\u2B50 Destacado"),o())}function X(r,e){if(r&1){let t=v();n(0,"article",27)(1,"div",28),E(2,"img",29),m(3,K,2,0,"span",30),o(),n(4,"div",31)(5,"span",32),i(6),o(),n(7,"h3",33),i(8),o(),n(9,"p",34),i(10),o(),n(11,"div",35)(12,"span",36),i(13),F(14,"currency"),o(),n(15,"div",37),i(16),o()(),n(17,"div",38)(18,"a",39),i(19," \u{1F441}\uFE0F Ver detalle "),o(),n(20,"button",40),g("click",function(){let c=p(t).$implicit,y=d(2);return _(y.navigateWithState(c))}),i(21," \u{1F4E6} Ver con datos "),o(),n(22,"button",41),g("click",function(){let c=p(t).$implicit,y=d(2);return _(y.deleteProduct(c))}),i(23," \u{1F5D1}\uFE0F "),o()()()()}if(r&2){let t=e.$implicit;s(2),O("src",t.image,S)("alt",t.name),s(),f(t.featured?3:-1),s(3),x(t.category),s(2),x(t.name),s(2),x(t.description),s(3),x(N(14,13,t.price,"EUR")),s(2),P("products__card-stock--low",t.stock<5),s(),M(" Stock: ",t.stock," "),s(2),O("routerLink",V(16,B,t.id)),s(4),D("aria-label",T("Eliminar ",t.name))}}function Z(r,e){if(r&1&&(n(0,"div",8),k(1,X,24,18,"article",27,R),o()),r&2){let t=d();s(),w(t.filteredProducts())}}function tt(r,e){if(r&1){let t=v();i(0),n(1,"button",46),g("click",function(){p(t);let c=d(2);return _(c.clearCategoryFilter())}),i(2," Ver todos los productos "),o()}if(r&2){let t=d(2);M(' No encontramos productos en la categor\xEDa "',t.currentCategory(),'". ')}}function et(r,e){r&1&&i(0," A\xFAn no hay productos registrados. \xA1S\xE9 el primero en a\xF1adir uno! ")}function rt(r,e){if(r&1){let t=v();n(0,"div",9)(1,"div",42),i(2,"\u{1F4E6}"),o(),n(3,"h3",43),i(4,"No hay productos disponibles"),o(),n(5,"p",44),m(6,tt,3,1)(7,et,1,0),o(),n(8,"button",45),g("click",function(){p(t);let c=d();return _(c.goToNewProduct())}),i(9," \u2795 A\xF1adir primer producto "),o()()}if(r&2){let t=d();s(6),f(t.currentCategory()?6:7)}}function ot(r,e){if(r&1){let t=v();n(0,"footer",10)(1,"button",45),g("click",function(){p(t);let c=d();return _(c.goToNewProduct())}),i(2," \u2795 A\xF1adir Producto "),o(),n(3,"button",18),g("click",function(){p(t);let c=d();return _(c.retryLoad())}),i(4," \u{1F504} Actualizar lista "),o()()}}var q=class r{productService=C(H);router=C(Y);route=C($);state=h({loading:!0,error:null,data:[],successMessage:null});hasProducts=b(()=>this.state().data.length>0);isEmpty=b(()=>!this.state().loading&&!this.state().error&&this.state().data.length===0);hasError=b(()=>!!this.state().error);isLoading=b(()=>this.state().loading);hasSuccess=b(()=>!!this.state().successMessage);filteredProducts=b(()=>{let e=this.currentCategory();return e?this.state().data.filter(t=>t.category.toLowerCase()===e.toLowerCase()):this.state().data});currentCategory=h(null);searchTerm=h("");ngOnInit(){this.checkNavigationState(),this.subscribeToQueryParams(),this.loadProducts()}checkNavigationState(){let e=history.state;e?.error&&this.state.update(t=>u(l({},t),{error:e.error})),e?.newProduct&&(this.state.update(t=>u(l({},t),{successMessage:`Producto "${e.newProduct.name}" creado exitosamente`})),this.autoHideSuccessMessage()),e?.deletedProduct&&(this.state.update(t=>u(l({},t),{successMessage:"Producto eliminado exitosamente"})),this.autoHideSuccessMessage())}subscribeToQueryParams(){this.route.queryParams.subscribe(e=>{e.category&&this.currentCategory.set(e.category),e.search&&this.searchTerm.set(e.search)})}loadProducts(){this.state.update(e=>u(l({},e),{loading:!0,error:null})),this.productService.getProducts().subscribe({next:e=>{this.state.update(t=>u(l({},t),{data:e,loading:!1}))},error:e=>{console.error("Error cargando productos:",e),this.state.update(t=>u(l({},t),{loading:!1,error:e.friendlyMessage||e.message||"Error al cargar los productos"}))}})}retryLoad(){this.loadProducts()}goToDetail(e){this.router.navigate(["/productos",e])}filterByCategory(e){this.router.navigate(["/productos"],{queryParams:{category:e,page:1},queryParamsHandling:"merge"})}clearCategoryFilter(){this.currentCategory.set(null),this.router.navigate(["/productos"],{queryParams:{category:null},queryParamsHandling:"merge"})}navigateWithState(e){this.router.navigate(["/productos",e.id],{state:{fromList:!0,previousProduct:e,timestamp:Date.now()}})}goToNewProduct(){this.router.navigate(["/productos","nuevo"])}deleteProduct(e){confirm(`\xBFEst\xE1s seguro de eliminar "${e.name}"?`)&&(this.state.update(a=>u(l({},a),{loading:!0})),this.productService.deleteProduct(e.id).subscribe({next:()=>{this.state.update(a=>u(l({},a),{loading:!1,data:a.data.filter(c=>c.id!==e.id),successMessage:`Producto "${e.name}" eliminado exitosamente`})),this.autoHideSuccessMessage()},error:a=>{this.state.update(c=>u(l({},c),{loading:!1,error:a.friendlyMessage||"Error al eliminar el producto"}))}}))}dismissError(){this.state.update(e=>u(l({},e),{error:null}))}dismissSuccess(){this.state.update(e=>u(l({},e),{successMessage:null}))}autoHideSuccessMessage(){setTimeout(()=>{this.dismissSuccess()},5e3)}getCategories(){let e=new Set(this.state().data.map(t=>t.category));return Array.from(e)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=z({type:r,selectors:[["app-product-list"]],decls:13,vars:7,consts:[[1,"products"],[1,"products__header"],[1,"products__title"],[1,"products__subtitle"],["role","alert",1,"products__toast","products__toast--success"],["role","alert",1,"products__alert","products__alert--error"],["aria-label","Filtrar por categor\xEDa",1,"products__filters"],["role","status","aria-live","polite",1,"products__loading"],[1,"products__grid"],["role","status",1,"products__empty"],[1,"products__footer"],[1,"products__toast-icon"],[1,"products__toast-message"],["aria-label","Cerrar mensaje",1,"products__toast-close",3,"click"],[1,"products__alert-content"],[1,"products__alert-icon"],[1,"products__alert-text"],[1,"products__alert-actions"],[1,"products__btn","products__btn--secondary",3,"click"],["aria-label","Cerrar error",1,"products__alert-close",3,"click"],[1,"products__filters-label"],[1,"products__filter-btn",3,"click"],[1,"products__filter-btn",3,"products__filter-btn--active"],[1,"products__spinner"],[1,"products__spinner-ring"],[1,"products__spinner-icon"],[1,"products__loading-text"],[1,"products__card"],[1,"products__card-image"],["loading","lazy",3,"src","alt"],[1,"products__card-badge"],[1,"products__card-content"],[1,"products__card-category"],[1,"products__card-title"],[1,"products__card-description"],[1,"products__card-footer"],[1,"products__card-price"],[1,"products__card-stock"],[1,"products__card-actions"],[1,"products__card-btn","products__card-btn--primary",3,"routerLink"],[1,"products__card-btn","products__card-btn--secondary",3,"click"],[1,"products__card-btn","products__card-btn--danger",3,"click","aria-label"],[1,"products__empty-icon"],[1,"products__empty-title"],[1,"products__empty-text"],[1,"products__btn","products__btn--primary",3,"click"],[1,"products__link",3,"click"]],template:function(t,a){t&1&&(n(0,"section",0)(1,"header",1)(2,"h1",2),i(3,"\u{1F995} Nuestros Productos"),o(),n(4,"p",3),i(5,"Descubre nuestra colecci\xF3n de productos educativos sobre dinosaurios"),o()(),m(6,Q,7,1,"div",4),m(7,U,14,1,"div",5),m(8,G,7,2,"nav",6),m(9,J,7,0,"div",7),m(10,Z,3,0,"div",8),m(11,rt,10,1,"div",9),m(12,ot,5,0,"footer",10),o()),t&2&&(s(6),f(a.hasSuccess()?6:-1),s(),f(a.hasError()?7:-1),s(),f(!a.isLoading()&&a.hasProducts()?8:-1),s(),f(a.isLoading()?9:-1),s(),f(!a.isLoading()&&!a.hasError()&&a.hasProducts()?10:-1),s(),f(a.isEmpty()?11:-1),s(),f(!a.isLoading()&&!a.hasError()?12:-1))},dependencies:[A,j,I],styles:[".products[_ngcontent-%COMP%]{padding:var(--spacing-4);max-width:1200px;margin:0 auto}.products__header[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-4)}.products__title[_ngcontent-%COMP%]{font-family:var(--font-secondary);font-size:var(--font-size-4xl);color:var(--primary-color);margin-bottom:var(--spacing-1)}.products__subtitle[_ngcontent-%COMP%]{font-family:var(--font-primary);font-size:var(--font-size-xl);color:var(--text-color)}.products__toast[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-2);padding:var(--spacing-2);border-radius:12px;margin-bottom:var(--spacing-3);font-family:var(--font-primary);animation:_ngcontent-%COMP%_slideIn .3s ease-out}.products__toast--success[_ngcontent-%COMP%]{background-color:#d1fae5;border:2px solid #10b981;color:#065f46}.products__toast-icon[_ngcontent-%COMP%]{font-size:var(--font-size-3xl)}.products__toast-message[_ngcontent-%COMP%]{flex:1;font-size:var(--font-size-xl);font-weight:var(--font-weight-medium)}.products__toast-close[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:var(--font-size-xl);padding:var(--spacing-1);opacity:.7;transition:opacity .2s}.products__toast-close[_ngcontent-%COMP%]:hover{opacity:1}.products__alert[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-2);padding:var(--spacing-3);border-radius:12px;margin-bottom:var(--spacing-3);font-family:var(--font-primary)}@media(min-width:640px){.products__alert[_ngcontent-%COMP%]{flex-direction:row;align-items:center}}.products__alert--error[_ngcontent-%COMP%]{background-color:#fee2e2;border:2px solid #ef4444;color:#b91c1c}.products__alert-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--spacing-2);flex:1}.products__alert-icon[_ngcontent-%COMP%]{font-size:var(--font-size-3xl);flex-shrink:0}.products__alert-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:var(--font-size-xl);margin-bottom:var(--spacing-1)}.products__alert-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--font-size-lg);margin:0}.products__alert-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-2)}.products__alert-close[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:var(--font-size-xl);padding:var(--spacing-1)}.products__filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:var(--spacing-1);margin-bottom:var(--spacing-3);padding:var(--spacing-2);background-color:var(--background-color-hover);border-radius:12px}.products__filters-label[_ngcontent-%COMP%]{font-family:var(--font-primary);font-size:var(--font-size-lg);font-weight:var(--font-weight-semibold);color:var(--text-color);margin-right:var(--spacing-1)}.products__filter-btn[_ngcontent-%COMP%]{padding:var(--spacing-1) var(--spacing-2);border-radius:20px;border:2px solid var(--primary-color);background-color:transparent;color:var(--primary-color);font-family:var(--font-primary);font-size:var(--font-size-lg);font-weight:var(--font-weight-medium);cursor:pointer;transition:all .2s ease}.products__filter-btn[_ngcontent-%COMP%]:hover{background-color:var(--primary-color-hover);color:var(--text-color-light)}.products__filter-btn--active[_ngcontent-%COMP%]{background-color:var(--primary-color);color:var(--text-color-light)}.products__loading[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-8);color:var(--text-color);font-family:var(--font-primary)}.products__spinner[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;margin:0 auto var(--spacing-3)}.products__spinner-ring[_ngcontent-%COMP%]{position:absolute;inset:0;border:4px solid var(--primary-color-disabled);border-top-color:var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.products__spinner-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:32px;animation:_ngcontent-%COMP%_bounce 1s ease-in-out infinite}.products__loading-text[_ngcontent-%COMP%]{font-size:var(--font-size-xl);color:var(--primary-color);font-weight:var(--font-weight-medium)}.products__empty[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-8);color:var(--text-color);font-family:var(--font-primary)}.products__empty-icon[_ngcontent-%COMP%]{font-size:80px;display:block;margin-bottom:var(--spacing-3);animation:_ngcontent-%COMP%_float 3s ease-in-out infinite}.products__empty-title[_ngcontent-%COMP%]{font-family:var(--font-secondary);font-size:var(--font-size-3xl);color:var(--primary-color);margin-bottom:var(--spacing-2)}.products__empty-text[_ngcontent-%COMP%]{font-size:var(--font-size-xl);color:var(--text-color);margin-bottom:var(--spacing-3);max-width:400px;margin-inline:auto}.products__link[_ngcontent-%COMP%]{background:none;border:none;color:var(--primary-color);text-decoration:underline;cursor:pointer;font-size:inherit;font-family:inherit}.products__link[_ngcontent-%COMP%]:hover{color:var(--primary-color-hover)}.products__grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:var(--spacing-3);margin-bottom:var(--spacing-4)}.products__card[_ngcontent-%COMP%]{background-color:var(--background-color-hover);border-radius:16px;overflow:hidden;box-shadow:0 4px 6px #0000001a;transition:transform .3s ease,box-shadow .3s ease}.products__card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 25px #00000026}.products__card-image[_ngcontent-%COMP%]{position:relative;height:180px;background-color:var(--background-color);display:flex;align-items:center;justify-content:center}.products__card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80%;max-height:160px;object-fit:contain}.products__card-badge[_ngcontent-%COMP%]{position:absolute;top:var(--spacing-1);right:var(--spacing-1);background-color:var(--support-color);color:var(--text-color-light);padding:4px 12px;border-radius:20px;font-size:var(--font-size-sm);font-weight:var(--font-weight-semibold)}.products__card-content[_ngcontent-%COMP%]{padding:var(--spacing-2)}.products__card-category[_ngcontent-%COMP%]{display:inline-block;background-color:var(--secondary-color);color:var(--text-color-light);padding:2px 10px;border-radius:12px;font-size:var(--font-size-sm);font-weight:var(--font-weight-medium);margin-bottom:var(--spacing-1)}.products__card-title[_ngcontent-%COMP%]{font-family:var(--font-secondary);font-size:var(--font-size-2xl);color:var(--primary-color);margin-bottom:var(--spacing-1);line-height:var(--line-height-tight)}.products__card-description[_ngcontent-%COMP%]{font-family:var(--font-primary);font-size:var(--font-size-lg);color:var(--text-color);line-height:var(--line-height-normal);margin-bottom:var(--spacing-2);display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.products__card-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-2)}.products__card-price[_ngcontent-%COMP%]{font-family:var(--font-secondary);font-size:var(--font-size-3xl);color:var(--support-color);font-weight:var(--font-weight-bold)}.products__card-stock[_ngcontent-%COMP%]{font-family:var(--font-primary);font-size:var(--font-size-sm);color:var(--text-color);padding:4px 8px;background-color:var(--background-color);border-radius:8px}.products__card-stock--low[_ngcontent-%COMP%]{background-color:#fee2e2;color:#b91c1c;font-weight:var(--font-weight-semibold)}.products__card-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-1);flex-wrap:wrap}.products__card-btn[_ngcontent-%COMP%]{flex:1;min-width:100px;padding:var(--spacing-1) var(--spacing-2);border-radius:8px;font-family:var(--font-primary);font-size:var(--font-size-lg);font-weight:var(--font-weight-medium);text-align:center;text-decoration:none;cursor:pointer;transition:background-color .3s ease,transform .2s ease;border:none}.products__card-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.products__card-btn--primary[_ngcontent-%COMP%]{background-color:var(--primary-color);color:var(--text-color-light)}.products__card-btn--primary[_ngcontent-%COMP%]:hover{background-color:var(--primary-color-hover)}.products__card-btn--secondary[_ngcontent-%COMP%]{background-color:transparent;color:var(--primary-color);border:2px solid var(--primary-color)}.products__card-btn--secondary[_ngcontent-%COMP%]:hover{background-color:var(--primary-color);color:var(--text-color-light)}.products__card-btn--danger[_ngcontent-%COMP%]{flex:0;min-width:auto;background-color:transparent;color:#ef4444;border:2px solid #ef4444}.products__card-btn--danger[_ngcontent-%COMP%]:hover{background-color:#ef4444;color:#fff}.products__footer[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:var(--spacing-2);flex-wrap:wrap;padding-top:var(--spacing-3);border-top:2px solid var(--background-color)}.products__btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--spacing-1);padding:var(--spacing-2) var(--spacing-4);border-radius:12px;font-family:var(--font-primary);font-size:var(--font-size-xl);font-weight:var(--font-weight-semibold);text-decoration:none;border:none;cursor:pointer;transition:background-color .3s ease,transform .2s ease}.products__btn--primary[_ngcontent-%COMP%]{background-color:var(--support-color);color:var(--text-color-light)}.products__btn--primary[_ngcontent-%COMP%]:hover{background-color:var(--support-color-hover);transform:translateY(-2px)}.products__btn--secondary[_ngcontent-%COMP%]{background-color:transparent;color:var(--primary-color);border:2px solid var(--primary-color)}.products__btn--secondary[_ngcontent-%COMP%]:hover{background-color:var(--primary-color);color:var(--text-color-light)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-60%) scale(1.1)}}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}"]})};export{q as ProductList};
