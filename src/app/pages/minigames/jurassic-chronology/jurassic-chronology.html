<div class="chronology-game">
  @if (!gameStarted() && !showFinalResults()) {
    <!-- Pantalla de inicio -->
    <div class="game-intro">
      <div class="intro-content">
        <h2 class="game-title"> Cronolog√≠a Jur√°sica </h2>
        <p class="game-description">
          Demuestra tus conocimientos sobre los per√≠odos de la Era Mesozoica: Tri√°sico, Jur√°sico y Cret√°cico
        </p>
        <div class="timeline-preview">
          <div class="timeline-item">
            <div class="timeline-period">Tri√°sico</div>
            <div class="timeline-time">252-201 M.a.</div>
          </div>
          <div class="timeline-item">
            <div class="timeline-period">Jur√°sico</div>
            <div class="timeline-time">201-145 M.a.</div>
          </div>
          <div class="timeline-item">
            <div class="timeline-period">Cret√°cico</div>
            <div class="timeline-time">145-66 M.a.</div>
          </div>
        </div>
        <div class="intro-features">
          <div class="feature">
            <span class="feature-icon">üìö</span>
            <span class="feature-text">8 preguntas desafiantes</span>
          </div>
          <div class="feature">
            <span class="feature-icon">üß†</span>
            <span class="feature-text">Pon a prueba tu conocimiento</span>
          </div>
          <div class="feature">
            <span class="feature-icon">üèÜ</span>
            <span class="feature-text">Obt√©n tu puntuaci√≥n final</span>
          </div>
        </div>
        <button class="btn-start" (click)="startGame()">
          ¬°Comienza el Quiz!
        </button>
      </div>
    </div>
  }

  @if (gameStarted()) {
    <!-- Juego en progreso -->
    <div class="game-playing">
      <!-- Barra de progreso -->
      <div class="progress-section">
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="(currentQuestion() + 1) / totalQuestions * 100"></div>
        </div>
        <div class="progress-info">
          <span class="progress-text">Pregunta {{ currentQuestion() + 1 }} de {{ totalQuestions }}</span>
          <span class="score-text">Puntuaci√≥n: {{ score() }}</span>
        </div>
      </div>

      <!-- Pregunta -->
      <div class="question-content">
        <h3 class="question-title">{{ currentQuestionData.question }}</h3>

        <!-- Opciones de respuesta -->
        <div class="options-container">
          @for (option of currentQuestionData.options; track option) {
            <button
              class="option-btn"
              [class.option-btn--selected]="selectedAnswer() === option"
              [class.option-btn--correct]="showResult() && option === currentQuestionData.correctAnswer"
              [class.option-btn--incorrect]="showResult() && selectedAnswer() === option && option !== currentQuestionData.correctAnswer"
              [disabled]="showResult()"
              (click)="selectAnswer(option)">
              <span class="option-letter">
                @if (currentQuestionData.options[0] === option) { A }
                @if (currentQuestionData.options[1] === option) { B }
                @if (currentQuestionData.options[2] === option) { C }
              </span>
              <span class="option-text">{{ option }}</span>
            </button>
          }
        </div>

        <!-- Resultado -->
        @if (showResult()) {
          <div class="result-section">
            @if (isCorrect()) {
              <div class="result-feedback feedback--correct">
                <span class="feedback-emoji">‚ú®</span>
                <span class="feedback-text">¬°Respuesta Correcta!</span>
              </div>
            }
            @if (!isCorrect()) {
              <div class="result-feedback feedback--incorrect">
                <span class="feedback-emoji">ü§î</span>
                <span class="feedback-text">Respuesta Incorrecta</span>
              </div>
            }

            <!-- Explicaci√≥n -->
            <div class="explanation-box">
              <h4 class="explanation-title">üìñ Informaci√≥n:</h4>
              <p class="explanation-text">{{ currentQuestionData.explanation }}</p>
            </div>

            <!-- Bot√≥n siguiente -->
            @if (currentQuestion() < totalQuestions - 1) {
              <button class="btn-next" (click)="nextQuestion()">
                Siguiente Pregunta ‚Üí
              </button>
            }
            @if (currentQuestion() === totalQuestions - 1) {
              <button class="btn-next" (click)="nextQuestion()">
                Ver Resultados Finales
              </button>
            }
          </div>
        }
      </div>
    </div>
  }

  @if (showFinalResults()) {
    <!-- Pantalla de resultados finales -->
    <div class="game-results">
      <div class="results-content">
        <h2 class="results-title">üéì ¬°Quiz Completado! üéì</h2>

        <div class="results-score">
          <div class="score-display">
            <span class="score-label">Tu Puntuaci√≥n</span>
            <span class="score-value">{{ score() }}/{{ totalQuestions }}</span>
          </div>

          @if (score() === totalQuestions) {
            <div class="results-message message-perfect">
              <span class="message-emoji">‚≠ê</span>
              <span class="message-text">¬°Excelente! ¬°Eres un experto en cronolog√≠a!</span>
            </div>
          }
          @if (score() >= totalQuestions * 0.8 && score() < totalQuestions) {
            <div class="results-message message-good">
              <span class="message-emoji">üåü</span>
              <span class="message-text">¬°Muy bien! Demuestra que sabes mucho de los per√≠odos.</span>
            </div>
          }
          @if (score() >= totalQuestions * 0.5 && score() < totalQuestions * 0.8) {
            <div class="results-message message-ok">
              <span class="message-emoji">üëç</span>
              <span class="message-text">¬°Bien! Est√°s aprendiendo sobre la cronolog√≠a jur√°sica.</span>
            </div>
          }
          @if (score() < totalQuestions * 0.5) {
            <div class="results-message message-improve">
              <span class="message-emoji">üìö</span>
              <span class="message-text">¬°Sigue estudiando! Repite el quiz para aprender m√°s.</span>
            </div>
          }
        </div>

        <div class="results-buttons">
          <button class="btn-restart" (click)="restartGame()">
            Intentar de Nuevo
          </button>
        </div>
      </div>
    </div>
  }
</div>
