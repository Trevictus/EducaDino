<div class="shadow-game">
  @if (!gameStarted() && !showFinalResults()) {
    <!-- Pantalla de inicio -->
    <div class="game-intro">
      <div class="intro-content">
        <h2 class="game-title"> Adivina la Sombra </h2>
        <p class="game-description">
          Mira la silueta del dinosaurio y elige la respuesta correcta. Â¡Es muy fÃ¡cil!
        </p>
        <div class="intro-features">
          <div class="feature">
            <span class="feature-icon">ğŸ‘€</span>
            <span class="feature-text">Observa bien la sombra</span>
          </div>
          <div class="feature">
            <span class="feature-icon">ğŸ¯</span>
            <span class="feature-text">Elige la respuesta correcta</span>
          </div>
          <div class="feature">
            <span class="feature-icon">â­</span>
            <span class="feature-text">Completa todas las preguntas</span>
          </div>
        </div>
        <button class="btn-start" (click)="startGame()">
          Â¡Empezar!
        </button>
      </div>
    </div>
  }

  @if (gameStarted()) {
    <!-- Juego en progreso -->
    <div class="game-playing">
      <!-- Barra de progreso -->
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="(currentQuestion() + 1) / totalQuestions * 100"></div>
      </div>
      <div class="progress-text">
        Pregunta {{ currentQuestion() + 1 }} de {{ totalQuestions }}
      </div>

      <!-- Pregunta -->
      <div class="question-content">
        <h3 class="question-title">Â¿QuÃ© dinosaurio es este?</h3>

        <!-- Imagen de sombra -->
        <div class="shadow-container">
          <div class="shadow-image">
            <img
              [src]="currentQuestionData.shadowImage"
              [alt]="currentQuestionData.correctAnswer"
              class="shadow-img-silueta">
          </div>
        </div>

        <!-- Opciones de respuesta -->
        <div class="options-grid">
          @for (option of currentQuestionData.options; track option) {
            <button
              class="option-btn"
              [class.option-btn--selected]="selectedAnswer() === option"
              [class.option-btn--correct]="showResult() && option === currentQuestionData.correctAnswer"
              [class.option-btn--incorrect]="showResult() && selectedAnswer() === option && option !== currentQuestionData.correctAnswer"
              [disabled]="showResult()"
              (click)="selectAnswer(option)">
              {{ option }}
            </button>
          }
        </div>

        <!-- Resultado -->
        @if (showResult()) {
          <div class="result-feedback" [class.feedback--correct]="isCorrect()">
            @if (isCorrect()) {
              <div class="feedback-content">
                <span class="feedback-emoji">ğŸ‰</span>
                <span class="feedback-text">Â¡Correcto! Â¡Muy bien!</span>
              </div>
            }
            @if (!isCorrect()) {
              <div class="feedback-content">
                <span class="feedback-emoji">ğŸ’¡</span>
                <span class="feedback-text">
                  La respuesta correcta es: <strong>{{ currentQuestionData.correctAnswer }}</strong>
                </span>
              </div>
            }
          </div>

          <!-- BotÃ³n siguiente -->
          @if (currentQuestion() < totalQuestions - 1) {
            <button class="btn-next" (click)="nextQuestion()">
              Siguiente â†’
            </button>
          }
          @if (currentQuestion() === totalQuestions - 1) {
            <button class="btn-next" (click)="nextQuestion()">
              Ver Resultados
            </button>
          }
        }
      </div>
    </div>
  }

  @if (showFinalResults()) {
    <!-- Pantalla de resultados finales -->
    <div class="game-results">
      <div class="results-content">
        <h2 class="results-title">ğŸ‰ Â¡Juego Completado! ğŸ‰</h2>

        <div class="results-score">
          <div class="score-display">
            <span class="score-label">Tu PuntuaciÃ³n</span>
            <span class="score-value">{{ score() }}/{{ totalQuestions }}</span>
          </div>

          @if (score() === totalQuestions) {
            <div class="results-message message-perfect">
              <span class="message-emoji">â­</span>
              <span class="message-text">Â¡Excelente! Â¡Reconociste todas las sombras!</span>
            </div>
          }
          @if (score() >= totalQuestions * 0.8 && score() < totalQuestions) {
            <div class="results-message message-good">
              <span class="message-emoji">ğŸŒŸ</span>
              <span class="message-text">Â¡Muy bien! Tienes un gran ojo para las siluetas.</span>
            </div>
          }
          @if (score() >= totalQuestions * 0.5 && score() < totalQuestions * 0.8) {
            <div class="results-message message-ok">
              <span class="message-emoji">ğŸ‘</span>
              <span class="message-text">Â¡Bien! EstÃ¡s aprendiendo a reconocer dinosaurios.</span>
            </div>
          }
          @if (score() < totalQuestions * 0.5) {
            <div class="results-message message-improve">
              <span class="message-emoji">ğŸ“š</span>
              <span class="message-text">Â¡Sigue jugando! AprenderÃ¡s mÃ¡s sobre las siluetas.</span>
            </div>
          }
        </div>

        <div class="results-buttons">
          <button class="btn-restart" (click)="restartGame()">
            Jugar de Nuevo
          </button>
        </div>
      </div>
    </div>
  }
</div>
